using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using NRKernal.Record;
using NRKernal;

public class CameraTexture : MonoBehaviour
{
    //  UnityÈ¯°æ Test¿ë
    public bool onUnity = true;
    //
    public ulong timestamp;
    public Texture2D textureFull;

    public int width = 1280;
    public int height = 720;

    //Test¿ë
    [SerializeField] public Texture2D test_input;

    private NRRGBCamTexture RGBCamTexture { get; set; }


    // Start is called before the first frame update
    void Start()
    {
        RGBCamTexture = new NRRGBCamTexture();
        // Texture È¹µæ
        textureFull = RGBCamTexture.GetTexture();

        // Timestamp È¹µæ
        timestamp = RGBCamTexture.CurrentFrame.timeStamp;
        
        RGBCamTexture.Play();

        //onAir();
    }

    // Update is called once per frame
    void Update()
    {
        onAir();
        if (onUnity)
        {
            textureFull = test_input;
        }
    }

    public void onAir()
    {
        if (RGBCamTexture == null)
        {
            RGBCamTexture = new NRRGBCamTexture();
        }
        RGBCamTexture.Play();

        // Texture È¹µæ
        textureFull = RGBCamTexture.GetTexture();
        // Timestamp È¹µæ
        timestamp = RGBCamTexture.CurrentFrame.timeStamp;
    }
    public void Pause()
    {
        RGBCamTexture?.Pause();
    }
    public void Stop()
    {
        RGBCamTexture?.Stop();
        RGBCamTexture = null;
    }
    void OnDestroy()
    {
        RGBCamTexture?.Stop();
        RGBCamTexture = null;
    }
}
